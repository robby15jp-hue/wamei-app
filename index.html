<!-- ▼ Language switcher（ヘッダーのどこかに置く） -->
<div class="language-switcher" style="position:absolute;right:16px;top:16px;">
  <select id="langSel" style="padding:8px 10px;border-radius:10px;">
    <option value="en">English</option>
    <option value="ja">日本語</option>
    <option value="zh">中文</option>
    <option value="ko">한국어</option>
    <option value="fr">Français</option>
    <option value="de">Deutsch</option>
  </select>
</div>

<script>
/* ====== 1) 翻訳辞書（必要に応じて増やす） ====== */
const I18N = {
  en: {
    title: "Wamei — Kanji Atoji Maker",
    subtitle: "Enter a name (Latin or Katakana). We return readable kanji with positive meanings.",
    placeholder: "Enter your name (e.g., Mike, Karen, David, Tom…)",
    gen: "Generate",
    kana: "kana",
    romaji: "romaji",
    meanings: "Kanji meanings",
    copy: "Copy",
    share: "Share",
    note: "Dictionary-first → hybrid phonetics. Same name → same result."
  },
  ja: {
    title: "和名変換（WAMEI Converter）",
    subtitle: "英字/カナ入力OK。日本人が読める当て字と良い意味を返します。",
    placeholder: "名前を入力（例：Mike, Karen, David, Tom…）",
    gen: "✨ 変換する",
    kana: "kana",
    romaji: "romaji",
    meanings: "漢字の意味",
    copy: "コピー",
    share: "共有",
    note: "辞書優先 → 発音ハイブリッド。同名は常に同じ結果。"
  },
  zh: { title:"和名转换", subtitle:"输入姓名（拉丁或片假名），返回可读汉字与积极含义。",
        placeholder:"输入姓名（如：Mike, Karen…）", gen:"生成", kana:"读音", romaji:"罗马字",
        meanings:"汉字含义", copy:"复制", share:"分享", note:"词典优先 → 发音混合。同名同结果。" },
  ko: { title:"일본식 이름 변환", subtitle:"영문/가타카나 입력 OK. 읽기 쉬운 한자와 좋은 뜻을 반환.",
        placeholder:"이름 입력 (예: Mike, Karen…)", gen:"생성", kana:"kana", romaji:"romaji",
        meanings:"한자의 의미", copy:"복사", share:"공유", note:"사전 우선 → 발음 하이브리드. 동일 이름 동일 결과." },
  fr: { title:"Convertisseur de nom japonais", subtitle:"Saisissez un nom. Kanji lisibles + sens positifs.",
        placeholder:"Entrez un nom (ex : Mike, Karen…)", gen:"Générer", kana:"kana",
        romaji:"romaji", meanings:"Sens des kanji", copy:"Copier", share:"Partager",
        note:"Dictionnaire d'abord → phonétique hybride. Même nom → même résultat." },
  de: { title:"Japanischer Namens-Konverter", subtitle:"Name eingeben. Lesbare Kanji mit positiver Bedeutung.",
        placeholder:"Name eingeben (z. B. Mike, Karen…)", gen:"Generieren", kana:"Kana",
        romaji:"Romaji", meanings:"Kanji-Bedeutungen", copy:"Kopieren", share:"Teilen",
        note:"Wörterbuch zuerst → Hybrid-Aussprache. Gleicher Name → gleiches Ergebnis." }
};

/* ====== 2) 自動判定（URL > ローカル保存 > ブラウザ言語） ====== */
function detectLang(){
  // /en や ?lang=en に対応
  const pathLang = location.pathname.split('/').filter(Boolean)[0];
  const urlLang  = new URLSearchParams(location.search).get('lang');
  const saved    = localStorage.getItem('wamei_lang');
  const navLang  = (navigator.language||'en').slice(0,2);
  const cand = (urlLang || pathLang || saved || navLang || 'en').toLowerCase();
  return I18N[cand] ? cand : 'en';
}

/* ====== 3) 適用（data-i18n 属性に流し込む） ====== */
function applyLang(lang){
  const t = I18N[lang]; if(!t) return;
  document.documentElement.setAttribute('lang', lang);
  // テキスト
  const set = (sel, key)=>{ const el = document.querySelector(sel); if(el && t[key]) el.textContent = t[key]; };
  set('[data-i18n=title]', 'title');
  set('[data-i18n=subtitle]', 'subtitle');
  set('[data-i18n=gen]', 'gen');
  set('[data-i18n=meanings]', 'meanings');
  set('[data-i18n=copy]', 'copy');
  set('[data-i18n=share]', 'share');
  set('[data-i18n=note]', 'note');
  // プレースホルダ
  const inp = document.querySelector('#name');
  if(inp && t.placeholder) inp.placeholder = t.placeholder;
  // ラベル類（結果表示中の固定ラベル）
  document.querySelectorAll('[data-i18n-label="kana"]').forEach(el=>el.textContent=t.kana||'kana');
  document.querySelectorAll('[data-i18n-label="romaji"]').forEach(el=>el.textContent=t.romaji||'romaji');

  const sel = document.getElementById('langSel'); if(sel) sel.value = lang;
  localStorage.setItem('wamei_lang', lang);
}

/* ====== 4) 初期化 & 変更イベント ====== */
const currentLang = detectLang();
document.addEventListener('DOMContentLoaded', ()=>{
  applyLang(currentLang);
  const sel = document.getElementById('langSel');
  if(sel) sel.addEventListener('change', e=>{
    const lang = e.target.value;
    // /en などのURLでも動くよう、クエリを付与して履歴に残す（任意）
    const u = new URL(location.href); u.searchParams.set('lang', lang);
    history.replaceState(null,'',u);
    applyLang(lang);
  });
});
</script>
